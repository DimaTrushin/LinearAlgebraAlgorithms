\documentclass{article}

\usepackage[T1,T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[english,russian]{babel}

\usepackage[left=2cm,right=2cm, top=2cm,bottom=2cm,bindingoffset=0cm]{geometry}

\usepackage{amsmath,amsthm,amssymb,amsfonts}
\usepackage{mathtext}
\usepackage{mathdots}
\usepackage[all]{xy}
\usepackage[colorlinks=true, urlcolor=blue]{hyperref}  

\newcommand{\tr}{\operatorname{\mathrm{tr}}}
\newcommand{\MatrixDim}[3]{\operatorname{\mathrm{M}_{#2\,#3}}(#1)}
\newcommand{\Matrix}[2]{\operatorname{\mathrm{M}_{#2}}(#1)}
\newcommand{\rk}{\operatorname{rk}}
\newcommand{\diag}{\operatorname{diag}}
\renewcommand{\Im}{\operatorname{Im}}

\renewcommand{\thesubsection}{\arabic{subsection}}

\begin{document}

\section*{Алгоритмы}

\subsection{Выделение базиса из системы векторов}

\paragraph{Дано}

Пусть $v_1,\ldots,v_m\in F^n$ -- вектора и $V = \langle v_1,\ldots,v_m\rangle$ -- их линейная оболочка.

\paragraph{Задача}

Среди векторов $v_1,\ldots,v_m$ найти базис пространства $V$ и разложить оставшиеся вектора по этому базису.

\paragraph{Алгоритм}

\begin{enumerate}
\item Запишем вектора $v_1,\ldots,v_m$ по столбцам в матрицу $A \in \MatrixDim{F}{n}{m}$.
Например, при $n = 3$, $m = 5$
\[
A = 
\begin{pmatrix}
{v_{11}}&{v_{21}}&{v_{31}}&{v_{41}}&{v_{51}}\\
{v_{12}}&{v_{22}}&{v_{32}}&{v_{42}}&{v_{52}}\\
{v_{13}}&{v_{23}}&{v_{33}}&{v_{43}}&{v_{53}}\\
\end{pmatrix}
\]

\item Приведем матрицу $A$ элементарными преобразованиями строк к улучшенному ступенчатому виду.
Например
\[
A' = 
\begin{pmatrix}
{1}&{0}&{a_{31}}&{0}&{a_{51}}\\
{0}&{1}&{a_{32}}&{0}&{a_{52}}\\
{0}&{0}&{0}&{1}&{a_{53}}\\
\end{pmatrix}
\]

\item Пусть $k_1,\ldots,k_r$ -- номера главных позиций в матрице $A'$.
Тогда вектора $v_{k_1},\ldots,v_{k_r}$ образуют базис $V$.
Например, в примере выше это вектора $v_1$, $v_2$ и $v_4$.

\item Пусть $v_i$ -- вектор соответствует неглавной позиции в $A'$.
Тогда в $i$-ом столбце $A'$ записаны координаты разложения $v_i$ через найденный базис выше.
Например, в примере выше $v_3 = a_{31}v_1 + a_{32}v_2$ и $v_5 = a_{51}v_1 + a_{52}v_2 + a_{53}v_4$.
\end{enumerate}

\paragraph{Пример}

Пусть 
\[
v_1 =
\begin{pmatrix}
{1}\\{3}\\{2}
\end{pmatrix},\,
v_2 =
\begin{pmatrix}
{1}\\{2}\\{1}
\end{pmatrix},\,
v_3 =
\begin{pmatrix}
{5}\\{12}\\{7}
\end{pmatrix},\,
v_4 =
\begin{pmatrix}
{1}\\{1}\\{1}
\end{pmatrix},\,
v_5 =
\begin{pmatrix}
{-1}\\{1}\\{0}
\end{pmatrix}\in F^3
\]
Тогда
\begin{gather*}
\begin{pmatrix}
{1}&{1}&{5}&{1}&{-1}\\
{3}&{2}&{12}&{1}&{1}\\
{2}&{1}&{7}&{1}&{0}\\
\end{pmatrix}\mapsto
\begin{pmatrix}
{1}&{1}&{5}&{1}&{-1}\\
{0}&{0}&{0}&{-1}&{2}\\
{2}&{1}&{7}&{1}&{0}\\
\end{pmatrix}\mapsto
\begin{pmatrix}
{1}&{1}&{5}&{1}&{-1}\\
{0}&{0}&{0}&{-1}&{2}\\
{1}&{0}&{2}&{0}&{1}\\
\end{pmatrix}\mapsto\\\mapsto
\begin{pmatrix}
{1}&{0}&{2}&{0}&{1}\\
{1}&{1}&{5}&{1}&{-1}\\
{0}&{0}&{0}&{1}&{-2}\\
\end{pmatrix}\mapsto
\begin{pmatrix}
{1}&{0}&{2}&{0}&{1}\\
{0}&{1}&{3}&{1}&{-2}\\
{0}&{0}&{0}&{1}&{-2}\\
\end{pmatrix}\mapsto
\begin{pmatrix}
{1}&{0}&{2}&{0}&{1}\\
{0}&{1}&{3}&{0}&{0}\\
{0}&{0}&{0}&{1}&{-2}\\
\end{pmatrix}
\end{gather*}
Тогда $v_1$, $v_2$ и $v_4$ -- базис линейной оболочки и $v_3 = 2v_1 + 3 v_2$ и $v_5 = v_1 - 2 v_4$.

\subsection{Нахождение какого-то базиса линейной оболочки}

\paragraph{Дано}

Пусть $v_1,\ldots,v_m\in F^n$ -- вектора и $V = \langle v_1,\ldots,v_m\rangle$ -- их линейная оболочка.

\paragraph{Задача}

Найти какой-нибудь базис подпространства $V$.

\paragraph{Алгоритм}

\begin{enumerate}
\item Уложить все вектора $v_i$ в строки матрицы $A\in \MatrixDim{F}{m}{n}$.

\item Элементарными преобразованиями строк привести матрицу к ступенчатому виду.

\item Ненулевые строки полученной матрицы будут искомым базисом.
\end{enumerate}

\subsection{Дополнение линейно независимой системы до базиса всего пространства стандартными векторами}

\paragraph{Дано}

Пусть $v_1,\ldots,v_m\in F^{n}$ -- линейно независимая система векторов, $V = \langle v_1,\ldots,v_m \rangle$ -- их линейная оболочка и $e_i$ -- стандартные базисные векторы, т.е. на $i$-ом месте стоит $1$, а в остальных $0$.

\paragraph{Задача}

Найти такие вектора $e_{k_1},\ldots, e_{k_{n-m}}$, что система $v_1,\ldots,v_m,e_{k_1},\ldots,e_{k_{n-m}}$ является базисом $F^{n}$.

\paragraph{Алгоритм}

\begin{enumerate}
\item Уложить вектора $v_i$ в строки матрицы $A\in\MatrixDim{F}{m}{n}$.

\item Привести матрицу $A$ к ступенчатому виду.

\item Пусть $k_1,\ldots,k_{n-m}$ -- номера неглавных столбцов.
Тогда $e_1,\ldots,e_{k_{n-m}}$ -- искомое множество.
\end{enumerate}

\subsection{Найти ФСР однородной СЛУ}

\paragraph{Дано}

Система однородных линейных уравнений $Ax = 0$, где $A\in \MatrixDim{F}{m}{n}$ и $x\in F^{n}$.

\paragraph{Задача}

Найти ФСР системы $Ax = 0$.

\paragraph{Алгоритм}

\begin{enumerate}
\item Привести матрицу $A$ элементарными преобразованиями строк к улучшенному ступенчатому виду.
Например
\[
A' = 
\begin{pmatrix}
{1}&{0}&{a_{31}}&{0}&{a_{51}}\\
{0}&{1}&{a_{32}}&{0}&{a_{52}}\\
{0}&{0}&{0}&{1}&{a_{53}}\\
\end{pmatrix}
\]

\item Пусть $k_1,\ldots,k_r$ -- позиции свободных переменных.
Если положить одну из этих переменных равной $1$, а все остальные нулями, то существует единственное решение, которое мы обозначим через $u_i$ (всего $r$ штук).
Например, для матрицы $A'$ выше свободные переменные имеют номера $3$ и $5$.
Тогда вектора (записанные в строку)
\[
u_1 = 
\begin{pmatrix}
{-a_{31}}&{-a_{32}}&{1}&{0}&{0}
\end{pmatrix},\,
u_2 = 
\begin{pmatrix}
{-a_{51}}&{-a_{52}}&{0}&{-a_{53}}&{1}
\end{pmatrix}
\]
являются ФСР.
\end{enumerate}

\subsection{Задать подпространство базисом, если оно задано матричным уравнением}

\paragraph{Дано}

Пусть $A\in\MatrixDim{F}{m}{n}$ и $V\subseteq F^{n}$ задано в виде $V = \{y\in F^{n}\mid A y = 0\}$.

\paragraph{Задача}

Найти базис подпространства $V$.

\paragraph{Алгоритм}

\begin{enumerate}
\item Найти ФСР системы $Ay = 0$.
Векторы ФСР будут базисом $V$.
\end{enumerate}

\subsection{Задать подпространство матричным уравнением, если оно задано линейной оболочной}

\paragraph{Дано}

Пусть $v_1,\ldots,v_k\in F^{n}$ -- набор векторов и $V = \langle v_1,\ldots,v_k \rangle$.

\paragraph{Задача}

Для некоторого $m$ найти матрицу $A\in\MatrixDim{F}{m}{n}$ такую, что $V = \{y\in F^{n}\mid Ay = 0\}$.

\paragraph{Алгоритм}

\begin{enumerate}
\item Уложить вектора $v_i$ в строки матрицы $B\in \MatrixDim{F}{k}{n}$.

\item Найти ФСР системы $Bz = 0$.

\item Уложить ФСР в строки матрицы $A\in \MatrixDim{F}{m}{n}$, где $m$ -- количество векторов в ФСР.
Матрица $A$ и будет искомой.
\end{enumerate}

\subsection{Найти матрицу замены координат}

\paragraph{Дано}

Векторное пространство $V$, $e=(e_1,\ldots,e_n)$ и $f = (f_1,\ldots,f_n)$ -- два базиса пространства $V$.
Известна матрица перехода от $e$ к $f$, т.е. $(f_1,\ldots,f_n) = (e_1,\ldots,e_n)A$, где $A\in \Matrix{F}{n}$.
Дан вектор $v = x_1e_1+\ldots+x_n e_n$.

\paragraph{Задача}

Найти разложение $v$ по  базису $f$.

\paragraph{Алгоритм}

\begin{enumerate}
\item Если $v = e x$, где $x\in F^{n}$, а также $v = f y$, где $y\in F^{n}$, то $y = A^{-1}x$.
\end{enumerate}

\subsection{Найти матрицу линейного отображения при замене базиса}

\paragraph{Дано}

Векторное пространство $V$ с базисами $e=(e_1,\ldots,e_n)$ и $e'=(e'_1,\ldots,e'_n)$, а также векторное пространство $U$ с базисами $f = (f_1,\ldots,f_m)$ и $f' = (f'_1,\ldots,f'_m)$.
Известны матрицы перехода $(e'_1,\ldots,e'_n) = (e_1,\ldots,e_n)C$ и $(f'_1,\ldots,f'_m) = (f_1,\ldots,f_m)D$, где $C\in \Matrix{F}{n}$ и $D\in \Matrix{F}{m}$.
Дано линейное отображение $\phi\colon V\to U$ заданное в базисах $e$ и $f$ матрицей $A\in\MatrixDim{F}{n}{m}$, т.е. $\phi e = f A$.

\paragraph{Задача}

Найти матрицу отображения $\phi$ в базисах $e'$ и $f'$, то есть такую $A'\in \MatrixDim{F}{n}{m}$, что $\phi e' = f' A'$.

\paragraph{Алгоритм}

\begin{enumerate}
\item $A' = D^{-1} A C$.
\end{enumerate}


\subsection{Определить существует ли линейное отображение заданное на векторах}

\paragraph{Дано}

Векторное пространство $V$ над полем $F$ и набор векторов $v_1,\ldots,v_k\in V$, векторное пространство $U$ и набор векторов $u_1,\ldots,u_k\in U$.

\paragraph{Задача}

Определить существует ли линейное отображение $\phi\colon V\to U$ такое, что $\phi(v_i) = u_i$.

\paragraph{Алгоритм}

\begin{enumerate}
\item Среди векторов $v_1,\ldots,v_k$ выделить линейно независимые, а остальные разложить по ним.

\item Пусть на предыдущем этапе базис получился $v_1,\ldots,v_r$, а $v_{r + i} = a_{i1} v_1 + \ldots + a_{ir}v_r$.

\item Искомое линейное отображение $\phi$ существует тогда и только тогда, когда выполняются равенства $u_{r+i} = a_{i1}u_1 + \ldots + a_{ir}u_r$.%
\footnote{В частности, если все $v_i$ оказались линейно независимыми, то линейное отображение $\phi$ обязательно существует.}
\end{enumerate}

\subsection{Найти базис образа и ядра линейного отображения}

\paragraph{Дано}

$\phi\colon F^{n}\to F^{m}$ задан $x\mapsto Ax$, где $A\in\MatrixDim{F}{m}{n}$.

\paragraph{Задача}

Найти базис $\Im \phi\in F^{m}$ и базис $\ker \phi\in F^{n}$.

\paragraph{Алгоритм}

\begin{enumerate}
\item Выделить базис среди столбцов матрицы $A$.
В результате получится базис $\Im \phi$.

\item Найти ФСР системы $Ax = 0$.
Полученная ФСР будет базисом $\ker \phi$.
\end{enumerate}

\subsection{Найти линейное отображение с заданными ядром и образом}

\paragraph{Дано}

Пространства $U\subseteq F^n$ и $W \subseteq F^m$ такие, что $\dim U + \dim W = n$.

\paragraph{Задача}

Найти матрицу линейного отображения $\varphi \colon F^n \to F^m$ такого, что $U = \ker \varphi$ и $W = \Im \varphi$.

\paragraph{Алгоритм}

\begin{enumerate}
\item Задать подпространство $W$ с помощью базиса.
Пусть $b_1,\ldots,b_k$ -- базис $W$.
Определим матрицу $B = (b_1 |\ldots |b_k)$.

\item Задать подпространство $U$ системой с линейно независимыми строками $U = \{y\in F^n \mid A y = 0\}$.

\item В силу условия $\dim U + \dim W = n$ матрица $A$ будет иметь столько же строк, сколько столбцов в матрице $B$.
В этом случае искомое линейное отображение задается матрицей $BA$.
\end{enumerate}

\subsection{Найти сумму подпространств заданных линейными оболочками}

\paragraph{Дано}

Подпространства $V,U\subseteq F^{n}$ заданные в виде $V = \langle v_1,\ldots,v_m\rangle$, $U = \langle u_1,\ldots,u_k\rangle$, где $v_i,u_j\in F^{n}$.

\paragraph{Задача}

Найти базис $V + U$.

\paragraph{Алгоритм}

\begin{enumerate}
\item Надо найти базис линейной оболочки $\langle v_1,\ldots,v_m,u_1,\ldots,u_k\rangle$.
\end{enumerate}

\subsection{Найти пересечение подпространств заданных линейными оболочками}

\paragraph{Дано}

Подпространства $V,U\subseteq F^{n}$ заданные в виде $V = \langle v_1,\ldots,v_m\rangle$, $U = \langle u_1,\ldots,u_k\rangle$, где $v_i,u_j\in F^{n}$.

\paragraph{Задача}

Найти базис $V\cap U$.%
\footnote{В это задаче можно задать подпространства системами, потом найти пересечение в виде системы, потом задать результат базисом.
Но есть куда более эффективный способ.}

\paragraph{Алгоритм}

\begin{enumerate}
\item Найти ФСР системы $D x = 0$, где $D = (v_1|\ldots|v_m|u_1|\ldots|u_k)$ и $x = \left(\frac{\alpha}{\beta}\right)$, где $\alpha\in F^{m}$, $\beta\in F^{k}$.

\item Пусть $\left(\left.\left.\frac{\alpha_1}{\beta_1}\right|\ldots\right|\frac{\alpha_s}{\beta_s}\right)$ -- ФСР.
Далее есть две опции (из них вторая опция предпочтительнее!):
\begin{itemize}
\item Множество векторов $R = (v_1|\ldots|v_m)(\alpha_1|\ldots|\alpha_s)$ порождает $V\cap U$.
Среди $(\alpha_1|\ldots|\alpha_s)$ можно выкинуть те $\alpha_i$, для которых $\beta_i = 0$.%
\footnote{Если ФСР построен по стандартному базису, то останутся $\alpha_i$ с нулевыми свободными переменными.}

\item Множество векторов $R' = (u_1|\ldots|u_k)(\beta_1|\ldots|\beta_s)$ порождает  $V\cap U$.
Причем можно рассматривать только ненулевые $\beta_i$.
\end{itemize}

\item Выделить базис среди столбцов $R$.
Это и будет базис $V\cap U$.
\begin{itemize}
\item Если векторы $u_1,\ldots,u_k$ были линейно независимы изначально и $\beta_i,\ldots,\beta_s$ -- все ненулевые сегменты ФСР с прошлого шага, то $(u_1|\ldots|u_k)(\beta_i|\ldots|\beta_s)$ будет базисом $V\cap U$.
\end{itemize}
\end{enumerate}

\subsection{Найти пересечение подпространств заданных матричным уравнением}

\paragraph{Дано}

Подпространства $V,U\subseteq F^{n}$ заданные в виде $V = \{y\in F^{n}\mid Ay = 0\}$, $U = \{y\in F^{n}\mid By = 0\}$, где $A\in \MatrixDim{F}{m}{n}$ и $B\in \MatrixDim{F}{k}{n}$.

\paragraph{Задача}

Задать $V\cap U$ в виде $\{y\in F^{n}\mid D y = 0\}$ для некоторого $D\in\MatrixDim{F}{k}{n}$, где $\rk D = k\leqslant n$.

\paragraph{Алгоритм}

\begin{enumerate}
\item Рассмотреть матрицу $D' = \left(\frac{A}{B}\right)$.

\item Выделить среди строк $D'$ линейно независимую подсистему.
Результат и будет искомая $D$.
\end{enumerate}


\subsection{Найти пересечение подпространств заданных разными способами}

\paragraph{Дано}

Подпространства $V,U\subseteq F^{n}$ заданные в виде $V =\langle v_1,\ldots,v_m\rangle$, $U = \{y\in F^{n}\mid Ay = 0\}$, где $A\in \MatrixDim{F}{k}{n}$.

\paragraph{Задача}

Задать $V \cap U$ системой линейных уравнений.

\paragraph{Алгоритм}

\begin{enumerate}
\item Задать подпространство $V$ системой в виде $\{x\in F^n \mid Dx = 0\}$.

\item Тогда $V\cap U$ задается объединенной системой $\left(\frac{B}{D}\right)$.
\end{enumerate}


\subsection{Найти сумму подпространств заданных разными способами}

\paragraph{Дано}

Подпространства $V,U\subseteq F^{n}$ заданные в виде $V =\langle v_1,\ldots,v_m\rangle$, $U = \{y\in F^{n}\mid Ay = 0\}$, где $A\in \MatrixDim{F}{k}{n}$.

\paragraph{Задача}

Задать $V + U$ в виде $\{x\in F^n \mid Dx = 0\}$, где $D\in \MatrixDim{F}{t}{n}$ и $t = \rk D$.%
\footnote{Всегда можно задать $U$ линейной оболочкой, потом задать $V+U$ линейной оболочкой, а потом найти представление системой.
Я же покажу тут другой подход.}

\paragraph{Алгоритм}

\begin{enumerate}
\item Определим матрицу $B = (v_1|\ldots|v_m)$ и найдем ФСР для системы $B^tA^t x = 0$.
Пусть это будет $x_1,\ldots, x_t$.

\item Тогда матрица $D' = (x_1|\ldots|x_t)^tA$ задает $V + U$ системой.

\item Отобрать среди строк $D'$ линейно независимые и получить $D$.
\begin{itemize}
\item Если строки $A$ были линейно независимы, то строки $D'$ уже будут линейно независимыми.
\end{itemize}
\end{enumerate}

\subsection{Найти сумму подпространств заданных разными способами}

\paragraph{Дано}

Подпространства $V,U\subseteq F^{n}$ заданные в виде $V =\langle v_1,\ldots,v_m\rangle$, $U = \{y\in F^{n}\mid Ay = 0\}$, где $A\in \MatrixDim{F}{k}{n}$.

\paragraph{Задача}

Задать $V + U$ в виде линейной оболочки.

\paragraph{Алгоритм}

\begin{enumerate}
\item Задать подпространство $U$ с помощью линейной оболочки.

\item Объединить линейные оболочки для $V$ и для $U$.
\end{enumerate}

\subsection{Найти матрицу линейного оператора при замене базиса}

\paragraph{Дано}

Векторное пространство $V$ над полем $F$, $e=(e_1,\ldots,e_n)$ и $f = (f_1,\ldots,f_n)$ -- два базиса пространства $V$.
Известна матрица перехода от $e$ к $f$, т.е.
$(f_1,\ldots,f_n) = (e_1,\ldots,e_n)C$, где $C\in \Matrix{F}{n}$.
Дано линейное отображение $\phi\colon V\to V$ заданное в базисе $e$ матрицей $A\in\Matrix{F}{n}$, т.е. $\phi e = e A$.

\paragraph{Задача}

Найти матрицу отображения $\phi$ в базисе $f$.

\paragraph{Алгоритм}

\begin{enumerate}
\item Пусть $\phi f = f B$, где $B$ -- искомая матрица.
Тогда $B = C^{-1} A C$.
\end{enumerate}

\subsection{Найти проекцию вектора на подпространство вдоль другого подпространства}

\paragraph{Дано}

$F^{n} = V \oplus U$, где $V$ и $U$ заданы базисами $V = \langle v_1,\ldots,v_m\rangle$, $U = \langle u_1,\ldots,u_k\rangle$.
Пусть $z\in F^{n}$ раскладывается $z = v + u$, где $v\in V$ и $u\in U$.

\paragraph{Задача}

Найти $v$ и $u$.

\paragraph{Алгоритм}

\begin{enumerate}
\item Решить СЛУ $D x = z$, где $D = (v_1|\ldots|v_m|u_1|\ldots|u_k)$ и $x = \left(\frac{\alpha}{\beta}\right)$, где $\alpha\in F^{m}$ и $\beta\in F^{k}$.

\item Тогда $v = (v_1|\ldots|v_m)\alpha$ и $u = (u_1|\ldots|u_k)\beta$.
\end{enumerate}

\subsection{Найти оператор проекции на подпространство вдоль другого подпространства}

\paragraph{Дано}

$F^{n} = V \oplus U$, где $V$ задано базисом $V = \langle v_1,\ldots,v_m\rangle$, $U = \{y\in F^{n}\mid Ay = 0\}$, где $A\in \MatrixDim{F}{k}{n}$ и $\rk A = k \leqslant n$.

\paragraph{Задача}

Найти матрицу отображения $\phi\colon V\to V$ такого, что $\phi(U) = 0$ и $\phi(v) = v$ для любого $v\in V$.%
\footnote{Заметим, что если $z\in F^{n}$ раскладывается $z = v + u$, где $v\in V$ и $u\in U$, то $\phi(z) = v$.}

\paragraph{Алгоритм}

\begin{enumerate}
\item Положим $B = (v_1|\ldots|v_m)\in \MatrixDim{F}{n}{m}$.

\item Обязательно получится, что $m = k$ и матрица $AB$ невырождена.

\item Искомый $\phi$ имеет матрицу $B(AB)^{-1}A$.
\end{enumerate}

\subsection{Поиск собственных значений и векторов}

\paragraph{Дано}

Матрица $A\in\Matrix{F}{n}$.

\paragraph{Задача}

Найти все собственные значения $\lambda_i$ для $A$ и для каждого $\lambda_i$ найти базис пространства $V_{\lambda_i} = \{v\in F^{n}\mid A v = \lambda_i v\}$.

\paragraph{Алгоритм}

\begin{enumerate}
\item Посчитать характеристический многочлен $(-1)^n\chi_A(\lambda) = \det(A-\lambda E)$.

\item Найти корни многочлена $\chi_A(\lambda)$.
Корни $\{\lambda_1,\ldots,\lambda_k\}$ будут собственным значениями $A$.

\item Для каждого $\lambda_i$ найти ФСР системы $(A-\lambda_i E)x = 0$.
Тогда ФСР будет базисом $V_{\lambda_i}$.
\end{enumerate}

Если дополнительно найти с каждым собственным значением $\lambda_i$ его кратность $n_i$ в характеристическом многочлене, то на последнем шаге размер ФСР для $\lambda_i$ оценивается так.
Собственных векторов будет не меньше чем $1$ и не больше, чем $n_i$.

\subsection{Поиск корневых подпространств}

\paragraph{Дано}

Матрица $A\in\Matrix{F}{n}$.

\paragraph{Задача}

Найти все собственные значения $\lambda_i$ для $A$ и для каждого $\lambda_i$ найти базис пространства $V^{\lambda_i} = \{v\in F^{n}\mid \exists n\colon (A - \lambda_i E)^n v = 0\}$.

\paragraph{Алгоритм}

\begin{enumerate}
\item Посчитать характеристический многочлен $(-1)^n\chi_A(\lambda) = \det(A-\lambda E)$.

\item Найти корни многочлена $\chi_A(\lambda)$ с кратностями.
Корни $\{\lambda_1,\ldots,\lambda_k\}$ будут собственным значениями $A$.
И пусть кратности будут $\{n_1,\ldots, n_k\}$.

\item Для каждого $\lambda_i$ найти ФСР системы $(A-\lambda_i E)^{n_i}x = 0$.
Тогда ФСР будет базисом $V^{\lambda_i}$.
Обратите внимание, что для каждого $\lambda_i$ должно получиться ровно $n_i$ векторов.
\end{enumerate}

\subsection{Поиск инвариантных подпространств}

\paragraph{Дано}

Матрица $A\in\Matrix{F}{n}$.

\paragraph{Задача}

Найти все подпространства $U\subseteq F^n$ такие, что $A U \subseteq U$.

\paragraph{Алгоритм}

\begin{enumerate}
\item Для каждого вектора $v\in F^n$ найти главное инвариантное подпространство
\[
[v]_A = \langle v, Av, A^2v, \ldots, A^mv, \ldots\rangle
\]
Обратите внимание, что это <<творческий шаг>> тут нет общего алгоритма,%
\footnote{Если говорить правду, то алгоритм то есть, но он такой геморройный и требует знаний, которых пока у нас нет, так что да ну его.}
тут придется немного догадаться.

\item Описать все инвариантные подпространства, как конечные суммы главных, а именно любое инвариантное $U$ будет иметь вид $[v_1]_A + \ldots +[v_k]_A$, где $v_1,\ldots, v_k$ пробегает все возможные конечные наборы векторов.
\end{enumerate}

\subsection{Поиск инвариантных подпространств для диагонализуемого оператора}

\paragraph{Дано}

Матрица $A\in\Matrix{F}{n}$, задающая диагонализуемый оператор.

\paragraph{Задача}

Найти все подпространства $U\subseteq F^n$ такие, что $A U \subseteq U$.

\paragraph{Алгоритм}

\begin{enumerate}
\item В начале надо найти все собственные значения и собственные подпространства.
Пусть $\lambda_1,\ldots, \lambda_k$ -- все собственные значения с кратностями $n_1,\ldots,n_k$.
Тогда $F^n = V_{\lambda_1}\oplus \ldots \oplus V_{\lambda_k}$.

\item Надо выбрать произвольное подпространство $U_i\subseteq V_{\lambda_i}$ (включая нулевое и все $V_{\lambda_i}$ целиком).
Тогда $U_1,\ldots, U_k$ будут линейно независимыми и $U = U_1 \oplus \ldots \oplus U_k$ будут все возможные инвариантные подпространства.
\end{enumerate}

\subsection{Проверка на диагонализуемость}

\paragraph{Дано}

Матрица $A\in\Matrix{F}{n}$, задающая линейный оператор $\varphi\colon F^n\to F^n$.

\paragraph{Задача}

Выяснить существует ли базис, в котором $\varphi$ задается диагональной матрицей и если задается, то какой именно.
На матричном языке: существует ли невырожденная матрица $C\in \Matrix{F}{n}$ такая, что $C^{-1}AC$ является диагональной и найти эту диагональную матрицу.

\paragraph{Алгоритм}

\begin{enumerate}
\item Найдем характеристический многочлен $\chi(t)$ для $\varphi$, он же для $A$ по формуле $(-1)^n\chi(t) = \det(A-t E)$.

\item Проверим, раскладывается ли $\chi(t)$ на линейные множители над $F$, то есть представляется ли он в виде $\chi(t) = (t-\lambda_1)^{d_1} \ldots (t-\lambda_k)^{d_k}$.
Если не представляется, то $\varphi$ (или что то же самое $A$) не диагонализируется

\item Если $\chi(t) = (t-\lambda_1)^{d_1} \ldots (t-\lambda_k)^{d_k}$.
Найдем для каждого $\lambda_i$ базис $V_{\lambda_i}$ как ФСР системы $(A-\lambda_i E)x = 0$.
Если для хотя бы одного $i$ количество элементов в ФСР меньше соответствующей кратности корня $d_i$, то $\varphi$ не диагонализируется.

\item Если для каждого $i$ мы получили, что размер ФСР совпадает с кратностью корня, то есть $\dim V_{\lambda_i} = d_i$.
То $\varphi$ диагонализируется.
В этом случае матрица $C$ состоит из собственных векторов.
Если собственные векторы для $\lambda_i$ есть $\{v_{i1},\ldots,v_{id_i}\}$, то $C = (v_{11}|\ldots|v_{1d_1}|v_{21}|\ldots|v_{2d_2}|\ldots |v_{k1}|\ldots|v_{kd_k})$.
При этом в новом базисе будет диагональная матрица $C^{-1}AC =\operatorname{Diag}(\lambda_1,\ldots,\lambda_1,\lambda_2,\ldots,\lambda_2,\ldots,\lambda_k,\ldots,\lambda_k)$, где каждое $\lambda_i$ встречается $d_i$ раз.
\end{enumerate}

Заметим, что если поле $F$ алгебраически замкнуто, то первый шаг алгоритма выполнен автоматически, а именно, над алгебраически замкнутым полем любой многочлен разлагается на линейные множители.
Потому в этом случае вопрос о диагонализируемости -- это лишь проверка всех равенств $\dim V_{\lambda_i} = d_i$.

\subsection{Определить ЖНФ у оператора}

\paragraph{Дано}

Матрица $A\in \Matrix{F}{n}$, где поле $F$ алгебраически замкнуто.

\paragraph{Задача}

Определить все собственные значения и размеры клеток в жордановой нормальной форме.

\paragraph{Алгоритм}

\begin{enumerate}
\item Собственные значения совпадают со спектром их ищем, как корни характеристического многочлена $\chi_A(t) = (-1)^n\det(A - t E) = 0$.
Получаем набор корней и их кратности $(\lambda_1, n_1),\ldots,(\lambda_k,n_k)$.

\item Для каждого $\lambda_i$ суммарный размер клеток равен $n_i$.
Потому надо определить количество клеток для всех $k\in [1, n_i]$.
Количество клеток считается по формуле
\[
\text{количество клеток размера $k$ } = \rk (A - \lambda_i E)^{k+1} + \rk(A - \lambda_i E)^{k-1} - 2 \rk(A - \lambda_i E)^k
\]
\end{enumerate}

Обратите внимание, что если вы нашли $m$ клеток размера $k$, а кратность была $n_i$, то на оставшиеся клетки уходит $n_i - mk$ мест.
Этим можно пользоваться, чтобы не считать все количества клеток подряд.

\subsection{Определение ЖНФ у матриц $2$ на $2$}

\paragraph{Дано}

Матрица $A\in \Matrix{F}{2}$, где поле $F$ алгебраически замкнутое.

\paragraph{Найти}

Жорданова форма может быть одной из
\[
\begin{pmatrix}
{\lambda}&{}\\
{}&{\mu}\\
\end{pmatrix}
,\quad
\begin{pmatrix}
{\lambda}&{}\\
{}&{\lambda}\\
\end{pmatrix}
,\quad
\begin{pmatrix}
{\lambda}&{1}\\
{}&{\lambda}\\
\end{pmatrix}
\]
Определить какая форма в нашем случае и определить все числа.

\paragraph{Алгоритм}

Общая идея в том, чтобы подобрать инварианты, которые достаточно рассчитать для выбора из предоставленных вариантов.
\begin{enumerate}
\item Найдем характеристический многочлен $\chi_A(t) =\det(A - t E)$.
И посчитаем его корни.
Есть два варианта: 
\begin{enumerate}
\item два разных корня $\lambda$ и $\mu$.
В этом случае ЖНФ имеет вид
\[
\begin{pmatrix}
{\lambda}&{}\\
{}&{\mu}\\
\end{pmatrix}
\]

\item один корень $\lambda$ кратности $2$.
В этом случае, если $A = \lambda E$, то ЖНФ имеет вид
\[
\begin{pmatrix}
{\lambda}&{}\\
{}&{\lambda}\\
\end{pmatrix}
\]
В противном случае ЖНФ имеет вид
\[
\begin{pmatrix}
{\lambda}&{1}\\
{}&{\lambda}\\
\end{pmatrix}
\]
\end{enumerate}
\end{enumerate}

\subsection{Определить Жорданов базис у матриц $2$ на $2$}

\paragraph{Дано}

Матрица $A \in \Matrix{F}{2}$, где поле $F$ алгебраически замкнутое.

\paragraph{Задача}

Зная ЖНФ определить жорданов базис $f_1, f_2$.

\paragraph{Алгоритм}

\begin{enumerate}
\item Пусть ЖНФ имеет вид
\[
\begin{pmatrix}
{\lambda}&{}\\
{}&{\mu}
\end{pmatrix}
\]
В этом случае оператор диагонализум, а значит базис выбирается из собственных векторов.
Есть два способа найти их:
\begin{enumerate}
\item Вектор $f_1$ находим как ненулевое решение системы $(A- \lambda E) x = 0$, а вектор $f_2$ находим как ненулевое решение системы $(A - \mu E) x = 0$.

\item Вектор $f_1$ находим как ненулевой столбец матрицы $A - \mu E$, а вектор $f_2$ находим как ненулевой столбец матрицы $A-\lambda E$.
\end{enumerate}

\item Пусть ЖНФ имеет вид
\[
\begin{pmatrix}
{\lambda}&{}\\
{}&{\lambda}
\end{pmatrix}
\]
В этом случае подходит любой базис.

\item Пусть ЖНФ имеет вид
\[
\begin{pmatrix}
{\lambda}&{1}\\
{}&{\lambda}
\end{pmatrix}
\]
В этом случае жорданов базис образует цепочку
\[
\xymatrix@R=15pt@C=15pt{
  {f_2}\ar@{|->}[d]^{A-\lambda E}\\
  {f_1}\ar@{|->}[d]^{A-\lambda E}\\
  {0}
}
\]
В этом случае векторы базиса ищутся так
\begin{enumerate}
\item Выбираем случайный вектор $f_2$.
Всегда достаточно выбирать из стандартных базисных векторов.

\item Полагаем $f_1 = (A - \lambda E) f_2$.

\item Если $f_1 = 0$, то вернуться к выбору вектора $f_2$.
Если $f_1 \neq 0$, то $f_1, f_2$ -- искомый базис.
\end{enumerate}
\end{enumerate}

\subsection{Определение ЖНФ у матриц $3$ на $3$}

\paragraph{Дано}

Матрица $A\in \Matrix{F}{3}$, где поле $F$ алгебраически замкнуто.

\paragraph{Найти}

Жорданова форма может быть одной из
\[
\begin{pmatrix}
{\lambda}&{}&{}\\
{}&{\mu}&{}\\
{}&{}&{\gamma}\\
\end{pmatrix}
,\quad
\begin{pmatrix}
{\lambda}&{}&{}\\
{}&{\lambda}&{}\\
{}&{}&{\mu}\\
\end{pmatrix}
,\quad
\begin{pmatrix}
{\lambda}&{1}&{}\\
{}&{\lambda}&{}\\
{}&{}&{\mu}\\
\end{pmatrix}
,\quad
\begin{pmatrix}
{\lambda}&{}&{}\\
{}&{\lambda}&{}\\
{}&{}&{\lambda}\\
\end{pmatrix}
,\quad
\begin{pmatrix}
{\lambda}&{1}&{}\\
{}&{\lambda}&{}\\
{}&{}&{\lambda}\\
\end{pmatrix}
,\quad
\begin{pmatrix}
{\lambda}&{1}&{}\\
{}&{\lambda}&{1}\\
{}&{}&{\lambda}\\
\end{pmatrix}
\]
Определить какая форма в нашем случае и определить все числа.

\paragraph{Алгоритм}

Общая идея в том, чтобы подобрать инварианты, которые достаточно рассчитать для выбора из предоставленных вариантов.
\begin{enumerate}
\item Найдем характеристический многочлен $\chi_A(t) = - \det(A - tE)$ и посчитаем его корни.
Возможны следующие варианты:
\begin{itemize}
\item три разных корня $\lambda$, $\mu$, $\gamma$.

\item один корень $\lambda$ кратности $2$, один корень $\mu$ кратности $1$.

\item один корень $\lambda$ кратности $3$.
\end{itemize}

\item Три разных корня.
В этом случае ЖНФ имеет вид
\[
\begin{pmatrix}
{\lambda}&{}&{}\\
{}&{\mu}&{}\\
{}&{}&{\gamma}\\
\end{pmatrix}
\]

\item Два разных корня, $\lambda$ кратности $2$ и $\mu$ кратности $1$.
В этом случае, если $\rk (A - \lambda E) = 1$, то ЖНФ имеет вид
\[
\begin{pmatrix}
{\lambda}&{}&{}\\
{}&{\lambda}&{}\\
{}&{}&{\mu}\\
\end{pmatrix}
\]
В противном случае (то есть, если $\rk(A-\lambda E) = 2$) ЖНФ имеет вид
\[
\begin{pmatrix}
{\lambda}&{1}&{}\\
{}&{\lambda}&{}\\
{}&{}&{\mu}\\
\end{pmatrix}
\]

\item Один корень $\lambda$ кратности $3$.
Если $A = \lambda E$, то ЖНФ имеет вид
\[
\begin{pmatrix}
{\lambda}&{}&{}\\
{}&{\lambda}&{}\\
{}&{}&{\lambda}\\
\end{pmatrix}
\]
Если $\rk(A-\lambda E) = 1$, то ЖНФ имеет вид
\[
\begin{pmatrix}
{\lambda}&{1}&{}\\
{}&{\lambda}&{}\\
{}&{}&{\lambda}\\
\end{pmatrix}
\]
В противном случае (то есть $\rk(A - \lambda E) = 2$) ЖНФ имеет вид
\[
\begin{pmatrix}
{\lambda}&{1}&{}\\
{}&{\lambda}&{1}\\
{}&{}&{\lambda}\\
\end{pmatrix}
\]
\end{enumerate}

\subsection{Определить Жорданов базис у матриц $3$ на $3$}

\paragraph{Дано}

Матрица $A \in \Matrix{F}{3}$, где поле $F$ алгебраически замкнуто.

\paragraph{Задача}

Зная ЖНФ определить жорданов базис $f_1, f_2, f_3$.

\paragraph{Алгоритм}

\begin{enumerate}
\item Пусть ЖНФ имеет вид
\[
\begin{pmatrix}
{\lambda}&{}&{}\\
{}&{\mu}&{}\\
{}&{}&{\gamma}\\
\end{pmatrix}
\]
В этом случае оператор диагонализуем, а значит базис выбирается из собственных векторов.
Базис можно найти следующим образом.
Вектор $f_1$ -- ненулевое решение системы $(A - \lambda E) x = 0$, вектор $f_2 $ -- ненулевое решение системы $(A - \mu E) x = 0$, вектор $f_3$ -- ненулевое решение системы $(A - \gamma E) x = 0$.

\item Пусть ЖНФ имеет вид
\[
\begin{pmatrix}
{\lambda}&{}&{}\\
{}&{\lambda}&{}\\
{}&{}&{\mu}\\
\end{pmatrix}
\]
В этом случае оператор диагонализуем, а значит базис выбирается из собственных векторов.
Базис можно найти одним из двух способов ниже:
\begin{enumerate}
\item Вектор $f_3$ берется как решение системы $(A - \mu E) x = 0$, векторы $f_1, f_2$ берутся как ФСР системы $(A - \lambda E) x = 0$.

\item Вектор $f_3$ берется как ненулевой столбец матрицы $A - \lambda E$, векторы $f_1, f_2$ берутся, как линейно независимые столбцы матрицы $A - \mu  E$.
\end{enumerate}

\item Пусть ЖНФ имеет вид
\[
\begin{pmatrix}
{\lambda}&{}&{}\\
{}&{\lambda}&{}\\
{}&{}&{\lambda}\\
\end{pmatrix}
\]
В этом случае в качестве жорданова базиса годится любой базис.

\item Пусть ЖНФ имеет вид
\[
\begin{pmatrix}
{\lambda}&{1}&{}\\
{}&{\lambda}&{}\\
{}&{}&{\mu}\\
\end{pmatrix}
\]
В этом случае вектор $f_3$ находится как решение системы $(A - \mu E) x = 0$.
Векторы $f_1, f_2$ можно найти одним из следующих способов:
\begin{enumerate}
\item Найдем ФСР системы $(A - \lambda E)^2 x = 0$, пусть это будет $x_1, x_2$.
Тогда в качестве $f_2$ берем один из векторов $x_i$, а $f_1 = (A - \lambda E) f_2$.
В итоге выбираем такое $x_i$ в качестве $f_2$, чтобы $f_1$ был не ноль.

\item В качестве вектора $f_2$ перебираем столбцы матрицы $A - \mu E$ до тех пор, пока $f_1 = (A - \lambda E) f_2$ не станет ненулевым.
Как только $f_1$ будет не ноль, векторы $f_1, f_2$ -- искомые.
\end{enumerate}

\item Пусть ЖНФ имеет вид
\[
\begin{pmatrix}
{\lambda}&{1}&{}\\
{}&{\lambda}&{}\\
{}&{}&{\lambda}\\
\end{pmatrix}
\]
В этом случае жорданов базис имеет конфигурацию
\[
\xymatrix@R=15pt@C=40pt{
  {f_2}\ar@{|->}[d]^{A-\lambda E}&{}\\
  {f_1}\ar@{|->}[d]^{A-\lambda E}&{f_3}\ar@{|->}[d]^{A-\lambda E}\\
  {0}&{0}
}
\]
В этом случае базис ищем по следующему алгоритму
\begin{enumerate}
\item Вектор $f_2$ выбираем случайно из всего пространства $F^3$.
Всегда достаточно выбирать из стандартных базисных векторов.

\item Вектор $f_1 = (A - \lambda E) f_2$.
Если $f_1 = 0$, то возвращаемся к шагу выбора вектора $f_2$.

\item В случае когда $f_1\neq 0$ это будет вектор из $\ker (A - \lambda E)$, надо дополнить его до базиса ядра.
Это можно сделать так: находим ФСР для системы $(A - \lambda E) x = 0$ и дополняем $f_1$ любым вектором из ФСР, который не пропорционален $f_1$, это и будет $f_3$.
\end{enumerate}

\item Пусть ЖНФ имеет вид
\[
\begin{pmatrix}
{\lambda}&{1}&{}\\
{}&{\lambda}&{1}\\
{}&{}&{\lambda}\\
\end{pmatrix}
\]
В этом случае жорданов базис имеет конфигурацию
\[
\xymatrix@R=15pt@C=40pt{
  {f_3}\ar@{|->}[d]^{A-\lambda E}\\
  {f_2}\ar@{|->}[d]^{A-\lambda E}\\
  {f_1}\ar@{|->}[d]^{A-\lambda E}\\
  {0}
}
\]
В этом случае базис ищется по следующему алгоритму
\begin{enumerate}
\item Случайно выбираем $f_3$ из $F^3$.
Всегда достаточно выбирать из стандартных базисных векторов.

\item Положим $f_2 = (A - \lambda E) f_3$ и $f_1 = (A - \lambda E) f_2$.

\item Если вектор $f_1$ равен нулю, то возвращаемся к шагу выбора $f_3$ иначе получили нужный базис.
\end{enumerate}
\end{enumerate}

\subsection{Определение ЖНФ у матриц $4$ на $4$ с одним собственным значением}

\paragraph{Дано}

Матрица $A\in \Matrix{F}{4}$ с единственным собственным значением $\lambda\in F$, где поле $F$ алгебраически замкнуто.

\paragraph{Найти}

Жорданова форма может быть одной из
\[
\begin{pmatrix}
{\lambda}&{}&{}&{}\\
{}&{\lambda}&{}&{}\\
{}&{}&{\lambda}&{}\\
{}&{}&{}&{\lambda}\\
\end{pmatrix}
,\quad
\begin{pmatrix}
{\lambda}&{1}&{}&{}\\
{}&{\lambda}&{}&{}\\
{}&{}&{\lambda}&{}\\
{}&{}&{}&{\lambda}\\
\end{pmatrix}
,\quad
\begin{pmatrix}
{\lambda}&{1}&{}&{}\\
{}&{\lambda}&{}&{}\\
{}&{}&{\lambda}&{1}\\
{}&{}&{}&{\lambda}\\
\end{pmatrix}
,\quad
\begin{pmatrix}
{\lambda}&{1}&{}&{}\\
{}&{\lambda}&{1}&{}\\
{}&{}&{\lambda}&{}\\
{}&{}&{}&{\lambda}\\
\end{pmatrix}
,\quad
\begin{pmatrix}
{\lambda}&{1}&{}&{}\\
{}&{\lambda}&{1}&{}\\
{}&{}&{\lambda}&{1}\\
{}&{}&{}&{\lambda}\\
\end{pmatrix}
\]
Определить какая форма в нашем случае и определить собственное значение.

\paragraph{Алгоритм}

Общая идея в том, чтобы подобрать инварианты, которые достаточно рассчитать для выбора из предоставленных вариантов.
\begin{enumerate}
\item Найдем характеристический многочлен $\chi_A(t) = \det(A - t E)$.
Нам нужно найти его единственный корень.
Так как многочлен имеет вид $(t-\lambda)^4$, то можно найти его $3$-ю производную и решить $\chi_A(t)^{(3)} = 0$ для нахождения корня.
Это работает, если $2\neq 0$ и $3\neq 0$ в поле $F$.%
\footnote{Действительно, третья производная от  $(t-\lambda)^4$ будет $4! (t - \lambda)$.
Если $2$ и $3$ обратимы в $F$, то можно сократить на $4!$.}$%
{}^{,\,}$%
\footnote{Можно воспользоваться любым другим приемлемым способом по поиску корня многочлена.}

\item Если $A = \lambda E$, то ЖНФ имеет вид
\[
\begin{pmatrix}
{\lambda}&{}&{}&{}\\
{}&{\lambda}&{}&{}\\
{}&{}&{\lambda}&{}\\
{}&{}&{}&{\lambda}\\
\end{pmatrix}
\]

\item Если $\rk(A-\lambda E) = 1$, то ЖНФ имеет вид
\[
\begin{pmatrix}
{\lambda}&{1}&{}&{}\\
{}&{\lambda}&{}&{}\\
{}&{}&{\lambda}&{}\\
{}&{}&{}&{\lambda}\\
\end{pmatrix}
\]

\item Если $\rk (A - \lambda E) = 3$, то ЖНФ имеет вид
\[
\begin{pmatrix}
{\lambda}&{1}&{}&{}\\
{}&{\lambda}&{1}&{}\\
{}&{}&{\lambda}&{1}\\
{}&{}&{}&{\lambda}\\
\end{pmatrix}
\]

\item Если $\rk(A - \lambda E) = 2$, то надо посмотреть на $(A - \lambda E)^2$.
Если $(A - \lambda E)^2 = 0$, то ЖНФ имеет вид
\[
\begin{pmatrix}
{\lambda}&{1}&{}&{}\\
{}&{\lambda}&{}&{}\\
{}&{}&{\lambda}&{1}\\
{}&{}&{}&{\lambda}\\
\end{pmatrix}
\]
иначе (если $(A - \lambda E)^2 \neq 0$) ЖНФ имеет вид
\[
\begin{pmatrix}
{\lambda}&{1}&{}&{}\\
{}&{\lambda}&{1}&{}\\
{}&{}&{\lambda}&{}\\
{}&{}&{}&{\lambda}\\
\end{pmatrix}
\]
\end{enumerate}

\subsection{Определить Жорданов базис у матриц $4$ на $4$ с единственным собственным значением}

\paragraph{Дано}

Матрица $A \in \Matrix{F}{4}$ с единственным собственным значением $\lambda$, где поле $F$ алгебраически замкнутое.

\paragraph{Задача}

Зная ЖНФ определить жорданов базис $f_1, f_2, f_3, f_4$.

\paragraph{Алгоритм}

\begin{enumerate}
\item Пусть ЖНФ имеет вид
\[
\begin{pmatrix}
{\lambda}&{}&{}&{}\\
{}&{\lambda}&{}&{}\\
{}&{}&{\lambda}&{}\\
{}&{}&{}&{\lambda}\\
\end{pmatrix}
\]
В этом случае любой базис годится в качестве жорданова.

\item Пусть ЖНФ имеет вид
\[
\begin{pmatrix}
{\lambda}&{1}&{}&{}\\
{}&{\lambda}&{}&{}\\
{}&{}&{\lambda}&{}\\
{}&{}&{}&{\lambda}\\
\end{pmatrix}
\]
В этом случае конфигурация жорданова базиса будет следующая
\[
\xymatrix@R=15pt@C=40pt{
  {f_2}\ar@{|->}[d]^{A-\lambda E}&{}&{}\\
  {f_1}\ar@{|->}[d]^{A-\lambda E}&{f_3}\ar@{|->}[d]^{A-\lambda E}&{f_4}\ar@{|->}[d]^{A-\lambda E}\\
  {0}&{0}&{0}
}
\]
В этом случае базис находится по следующему алгоритму
\begin{enumerate}
\item Вектор $f_2$ выбираем случайно из $F^4$.
Всегда достаточно выбирать из стандартных базисных векторов.

\item Положим $f_1 = (A - \lambda E) f_2$.
Если вектор $f_1 = 0$, то вернемся к шагу выбора вектора $f_2$.

\item Вектор $f_1$ будет лежать в $\ker(A - \lambda E)$ теперь его надо дополнить до базиса ядра двумя векторами.
Это можно сделать так: находим ФСР системы $(A - \lambda E)x = 0$ и из трех векторов выберем два $f_3, f_4$, которые будут линейно независимы с $f_1$.
\end{enumerate}

\item Пусть ЖНФ имеет вид
\[
\begin{pmatrix}
{\lambda}&{1}&{}&{}\\
{}&{\lambda}&{1}&{}\\
{}&{}&{\lambda}&{}\\
{}&{}&{}&{\lambda}\\
\end{pmatrix}
\]
В этом случае конфигурация жорданова базиса будет следующая
\[
\xymatrix@R=15pt@C=40pt{
  {f_3}\ar@{|->}[d]^{A-\lambda E}&{}\\
  {f_2}\ar@{|->}[d]^{A-\lambda E}&{}\\
  {f_1}\ar@{|->}[d]^{A-\lambda E}&{f_4}\ar@{|->}[d]^{A-\lambda E}\\
  {0}&{0}
}
\]
В этом случае базис находится по следующему алгоритму
\begin{enumerate}
\item Вектор $f_3$ выбираем случайно в $F^4$.
Всегда достаточно выбирать из стандартных базисных векторов.

\item Положим $f_2 = (A - \lambda E) f_3$ и $f_1 = (A - \lambda E) f_2$.
Если $f_1 = 0$, то вернуться к шагу выбора вектора $f_3$.

\item Вектор $f_1$ лежит в $\ker (A - \lambda E)$, его надо дополнить одним вектором $f_4$ до базиса ядра.
Это можно сделать следующим образом.
Найдем ФСР системы $(A - \lambda E)x = 0$ и дополним вектор $f_1$ одним вектором из ФСР, чтобы полученная пара была линейно независима.
\end{enumerate}

\item Пусть ЖНФ имеет вид
\[
\begin{pmatrix}
{\lambda}&{1}&{}&{}\\
{}&{\lambda}&{1}&{}\\
{}&{}&{\lambda}&{1}\\
{}&{}&{}&{\lambda}\\
\end{pmatrix}
\]
В этом случае конфигурация жорданова базиса будет следующая
\[
\xymatrix@R=15pt@C=40pt{
  {f_4}\ar@{|->}[d]^{A-\lambda E}\\
  {f_3}\ar@{|->}[d]^{A-\lambda E}\\
  {f_2}\ar@{|->}[d]^{A-\lambda E}\\
  {f_1}\ar@{|->}[d]^{A-\lambda E}\\
  {0}
}
\]
В этом случае базис находится по следующему алгоритму
\begin{enumerate}
\item Вектор $f_4$ выбираем случайно из $F^4$.
Всегда достаточно выбирать из стандартных базисных векторов.

\item Положим $f_3 = (A - \lambda E) f_4$, $f_2 = (A - \lambda E) f_3$, $f_1 = (A - \lambda E) f_2$.
Если $f_1 = 0$, то вернуться к шагу перевыбора $f_4$ иначе получился искомый базис.
\end{enumerate}

\item Пусть ЖНФ имеет вид
\[
\begin{pmatrix}
{\lambda}&{1}&{}&{}\\
{}&{\lambda}&{}&{}\\
{}&{}&{\lambda}&{1}\\
{}&{}&{}&{\lambda}\\
\end{pmatrix}
\]
В этом случае конфигурация жорданова базиса будет следующая
\[
\xymatrix@R=15pt@C=40pt{
  {f_2}\ar@{|->}[d]^{A-\lambda E}&{f_4}\ar@{|->}[d]^{A-\lambda E}\\
  {f_1}\ar@{|->}[d]^{A-\lambda E}&{f_3}\ar@{|->}[d]^{A-\lambda E}\\
  {0}&{0}
}
\]
В этом случае базис можно найти по следующему алгоритму.
\begin{enumerate}
\item Выбираем вектор $f_2$ случайно в $F^4$.
Всегда достаточно выбирать из стандартных базисных векторов.

\item Положим $f_1 = (A - \lambda E) f_2$.
Если $f_1 = 0$, то вернуться к шагу выбора $f_2$.

\item Выбираем вектор $f_4$ случайно в $F^4$.
Всегда достаточно выбирать из стандартных базисных векторов.

\item Положим $f_3 = (A - \lambda E) f_4$.
Если векторы $f_1,  f_3$ линейно зависимы, вернуться к шагу выбора $f_4$.
Иначе получили искомый базис.

\end{enumerate}
\end{enumerate}

\end{document}